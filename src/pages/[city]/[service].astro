---
import Layout from "../../layouts/Layout.astro";
import { services, industries, cities } from "../../config/site-config";
import servicesContent from "../../data/services-content.json";
import cityContext from "../../data/city-context.json";
import { getContextualFAQs } from "../../data/faq-database";

export function getStaticPaths() {
  const paths = [];

  for (const city of cities) {
    for (const service of services) {
      paths.push({
        params: {
          city: city.slug,
          service: service.slug,
        },
        // In Astro 4+ inside [city]/[service].astro (depth 2),
        // props can be passed or fetched in the component
        props: { city, service },
      });
    }
  }

  return paths;
}

const { city, service } = Astro.props;
const content = servicesContent[service.slug as keyof typeof servicesContent];

// Deep Context
const cityData = (cityContext as any)[city.slug] || cityContext.default;

const localize = (text: string) => {
  if (!text) return "";
  return text
    .replace(/{city}/g, city.name)
    .replace(/{service}/g, service.name)
    .replace(/Gulf region/g, city.name)
    .replace(/UAE/g, city.country)
    .replace(/Dubai/g, city.name);
};

// Adjectives
const randomAdj = cityData.adjectives
  ? cityData.adjectives[Math.floor(Math.random() * cityData.adjectives.length)]
  : "leading";

const canonicalURL = new URL(Astro.url.pathname, "https://vdesignu.com");

// 4. Generate 35+ Unique FAQs for the Hub
const faqs = getContextualFAQs(city.slug, "", service.slug, 35);
---

<Layout
  title={`${service.name} Authority in ${city.name} | ${city.country} Digital Strategy`}
  description={`Maximize your digital footprint in ${city.name} with elite ${service.name.toLowerCase()} services. Engineered for ${cityData.adjectives[0]} growth and strictly compliant with ${cityData.regulations[0]?.name || "local"} standards.`}
  canonical={canonicalURL.toString()}
>
  <!-- Hero Section -->
  <section
    class="pt-48 pb-24 bg-[var(--bg-primary)] overflow-hidden relative border-b border-[var(--border-subtle)]"
  >
    <div
      class="absolute inset-0 bg-gradient-to-br from-[var(--accent-red)]/5 via-transparent to-[var(--accent-yellow)]/5"
    >
    </div>
    <div class="max-w-7xl mx-auto px-6 relative z-10">
      <div class="flex flex-col lg:flex-row gap-20 items-end">
        <div class="flex-1">
          <span
            class="inline-block px-4 py-1 rounded-full bg-[var(--bg-secondary)] border border-[var(--border-subtle)] text-[var(--accent-red)] text-xs font-black uppercase tracking-widest mb-8"
          >
            Strategic Regional Hub: {city.name}, {city.country}
          </span>
          <h1
            class="text-6xl md:text-9xl font-black italic uppercase tracking-tighter leading-[0.8] mb-10"
          >
            {service.name}
            <br />
            <span
              class="text-transparent bg-clip-text bg-gradient-to-r from-[var(--text-primary)] to-[var(--text-muted)]"
            >
              Authority in {city.name}
            </span>
          </h1>
          <p
            class="text-3xl text-[var(--text-secondary)] font-medium max-w-2xl leading-relaxed mb-12"
          >
            We engineering high-performance {service.name.toLowerCase()} systems tailored
            for the <strong>{randomAdj}</strong>
            {city.name} business pulse.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section 1: Strategic Market Context (Word Count Driver) -->
  <section class="py-24 bg-[var(--bg-secondary)]">
    <div class="max-w-5xl mx-auto px-6">
      <h2
        class="text-4xl md:text-6xl font-black italic uppercase tracking-tighter mb-12"
      >
        Scaling {service.name} in <span class="text-[var(--accent-red)]"
          >{city.name}</span
        >'s Economy.
      </h2>
      <div
        class="prose prose-2xl dark:prose-invert text-[var(--text-secondary)] max-w-none"
      >
        <p class="mb-12">
          The {city.name} market is defined by "{cityData.searchBehavior}".
          Traditional {service.name.toLowerCase()} approaches often fall short because
          they fail to account for the unique pressure of specific districts like
          <strong>{cityData.districts.join(", ")}</strong>. In {city.country},
          digital success is a mandate, not an option. With Vision-driven growth
          patterns and a {randomAdj} pace, your technical infrastructure must be as
          resilient as your business goals.
        </p>

        <div class="grid md:grid-cols-3 gap-8 not-prose my-20">
          <div
            class="p-8 bg-[var(--bg-primary)] rounded-3xl border border-[var(--border-subtle)]"
          >
            <h4
              class="text-[var(--accent-red)] font-black uppercase text-xs mb-4"
            >
              Penetration
            </h4>
            <p class="text-3xl font-black italic">
              {cityData.marketStats.internetPenetration}
            </p>
            <p
              class="text-xs text-[var(--text-muted)] mt-2 uppercase font-bold"
            >
              Internet Usage
            </p>
          </div>
          <div
            class="p-8 bg-[var(--bg-primary)] rounded-3xl border border-[var(--border-subtle)]"
          >
            <h4
              class="text-[var(--accent-yellow)] font-black uppercase text-xs mb-4"
            >
              Mobile Intent
            </h4>
            <p class="text-xl font-black uppercase leading-tight">
              {cityData.marketStats.mobileUsage}
            </p>
            <p
              class="text-xs text-[var(--text-muted)] mt-2 uppercase font-bold"
            >
              Search Behavior
            </p>
          </div>
          <div
            class="p-8 bg-[var(--bg-primary)] rounded-3xl border border-[var(--border-subtle)]"
          >
            <h4
              class="text-[var(--text-primary)] font-black uppercase text-xs mb-4"
            >
              Cultural Factor
            </h4>
            <p class="text-sm font-medium leading-relaxed">
              {cityData.culturalNuances}
            </p>
          </div>
        </div>

        <h3
          class="text-3xl font-black uppercase italic mt-16 text-[var(--text-primary)]"
        >
          The Regional Compliance Blueprint
        </h3>
        <p class="mb-10 text-xl leading-relaxed">
          Navigating the regulatory landscape of {city.name} is the first step toward
          digital dominance. Whether you are operating in the heart of {
            cityData.districts[0]
          } or scaling across the wider {city.country} region, your {
            service.name.toLowerCase()
          } campaigns must adhere to the rigorous standards set by local governing
          bodies. Failure to comply leads to more than just fines—it erodes the brand
          trust that is so difficult to build in a "{randomAdj}" market.
        </p>

        <ul class="grid md:grid-cols-2 gap-6 not-prose my-10">
          {
            cityData.regulations.map((reg: any) => (
              <li class="bg-[var(--bg-primary)] p-8 rounded-2xl border border-[var(--border-subtle)] hover:border-[var(--accent-red)] transition-all">
                <span class="block text-[var(--accent-red)] font-black uppercase text-xs mb-2">
                  {reg.agency}
                </span>
                <h4 class="text-lg font-bold mb-2 uppercase">
                  {reg.name || "Compliance Standard"}
                </h4>
                <p class="text-sm font-medium leading-relaxed text-[var(--text-secondary)]">
                  {reg.impact}
                </p>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </section>

  <!-- SECTION 3: TECHNICAL PERFORMANCE BENCHMARKS (Word Count margin) -->
  <section
    class="py-24 bg-[var(--bg-secondary)] border-y border-[var(--border-subtle)]"
  >
    <div class="max-w-5xl mx-auto px-6">
      <h2
        class="text-4xl md:text-6xl font-black italic uppercase tracking-tighter mb-12"
      >
        {service.name}
        <span class="text-[var(--accent-yellow)]">Technical</span> Benchmarks.
      </h2>
      <div
        class="prose prose-xl dark:prose-invert text-[var(--text-secondary)] max-w-none"
      >
        <p
          class="mb-12 text-xl leading-relaxed italic border-l-4 border-[var(--accent-red)] pl-8"
        >
          "In the {city.name} marketplace, speed is not a luxury—it is the foundation
          of trust. Our {service.name.toLowerCase()} systems are engineered to exceed
          Global Web Vitals while maintaining the high-fidelity aesthetics required
          by {city.country} luxury brands."
        </p>

        <div class="grid md:grid-cols-3 gap-8 not-prose my-16">
          <div
            class="p-10 bg-[var(--bg-primary)] rounded-[2.5rem] border border-[var(--border-subtle)]"
          >
            <h4
              class="text-xs font-black uppercase text-[var(--accent-red)] mb-4"
            >
              LCP (Load Speed)
            </h4>
            <p
              class="text-3xl font-black italic text-[var(--text-primary)] mb-2"
            >
              &lt; 1.2s
            </p>
            <p
              class="text-xs text-[var(--text-muted)] leading-relaxed uppercase font-bold"
            >
              Projected for {city.name} Edge Nodes
            </p>
          </div>
          <div
            class="p-10 bg-[var(--bg-primary)] rounded-[2.5rem] border border-[var(--border-subtle)]"
          >
            <h4
              class="text-xs font-black uppercase text-[var(--accent-yellow)] mb-4"
            >
              CLS (Visual Stability)
            </h4>
            <p
              class="text-3xl font-black italic text-[var(--text-primary)] mb-2"
            >
              0.00
            </p>
            <p
              class="text-xs text-[var(--text-muted)] leading-relaxed uppercase font-bold"
            >
              Standard for {service.name} interfaces
            </p>
          </div>
          <div
            class="p-10 bg-[var(--bg-primary)] rounded-[2.5rem] border border-[var(--border-subtle)]"
          >
            <h4
              class="text-xs font-black uppercase text-[var(--text-primary)] mb-4"
            >
              Authority Score
            </h4>
            <p
              class="text-3xl font-black italic text-[var(--text-primary)] mb-2"
            >
              Top 5%
            </p>
            <p
              class="text-xs text-[var(--text-muted)] leading-relaxed uppercase font-bold"
            >
              Target in {city.name}
              {service.name.split(" ")[0]} searches
            </p>
          </div>
        </div>

        <p class="mt-12">
          By hardware-accelerating our {service.name.toLowerCase()} rendering and
          utilizing semantic data meshes, vdesignu ensures that your brand doesn't
          just rank—it dominates the conversation in zones like <strong
            >{cityData.economicZones[0]?.name || cityData.districts[0]}</strong
          >. This technical superiority is what separates our partners from the
          rest of the {city.name} digital noise.
        </p>
      </div>
    </div>
  </section>

  <!-- Industry Solution Mesh -->
  <section class="py-24 bg-[var(--bg-primary)]">
    <div class="max-w-7xl mx-auto px-6">
      <div class="text-center mb-16">
        <h2
          class="text-4xl md:text-6xl font-black italic uppercase tracking-tighter"
        >
          Sector-Specific <span class="text-[var(--accent-red)]"
            >{service.name}</span
          >
        </h2>
        <p class="text-[var(--text-secondary)] mt-4">
          Deep expertise across {city.name}'s leading industries.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        {
          industries.slice(0, 12).map((industry) => (
            <a
              href={`/${city.slug}/${industry.slug}/${service.slug}`}
              class="group block p-8 bg-[var(--bg-card)] border border-[var(--border-subtle)] hover:border-[var(--accent-red)] rounded-3xl transition-all"
            >
              <h3 class="text-xl font-black uppercase tracking-tight mb-2 group-hover:text-[var(--accent-red)] transition-colors">
                {industry.name}
              </h3>
              <p class="text-xs text-[var(--text-muted)] uppercase tracking-widest font-bold">
                Explore Growth →
              </p>
            </a>
          ))
        }
      </div>
    </div>
  </section>

  <!-- SECTION 3: THE MEGA ROADMAP (Word Count Driver) -->
  <section
    class="py-24 bg-[var(--bg-primary)] border-b border-[var(--border-subtle)]"
  >
    <div class="max-w-7xl mx-auto px-6">
      <div class="text-center mb-20">
        <h2
          class="text-4xl md:text-7xl font-black italic uppercase tracking-tighter"
        >
          The <span class="text-[var(--accent-red)]">Performance</span> Roadmap.
        </h2>
        <p class="text-xl text-[var(--text-secondary)] mt-4">
          Elevating {service.name} for the {city.country} marketplace.
        </p>
      </div>
      <div class="grid md:grid-cols-2 lg:grid-cols-5 gap-6">
        {
          [
            {
              step: "01",
              title: "Intelligence",
              desc: "Audit of {city} search landscape and gaps.",
            },
            {
              step: "02",
              title: "Hardening",
              desc: "Optimizing for {cityData.marketStats.internetPenetration} benchmarks.",
            },
            {
              step: "03",
              title: "Governance",
              desc: "Adherence to {cityData.regulations[0]?.agency} standards.",
            },
            {
              step: "04",
              title: "Expansion",
              desc: "Scaling visibility in {cityData.districts[0]}.",
            },
            {
              step: "05",
              title: "Conversion",
              desc: "Tailoring flows for '{cityData.searchBehavior}' intent.",
            },
          ].map((phase, i) => (
            <div class="p-8 bg-[var(--bg-secondary)] border border-[var(--border-subtle)] rounded-3xl group hover:border-[var(--accent-red)] transition-all">
              <span class="text-4xl font-black italic text-[var(--accent-red)] opacity-20 group-hover:opacity-100 transition-opacity mb-4 block">
                0{i + 1}
              </span>
              <h3 class="text-lg font-black uppercase mb-2 leading-tight">
                {phase.title}
              </h3>
              <p class="text-xs text-[var(--text-secondary)] italic leading-relaxed">
                {phase.desc}
              </p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- SECTION 4: THE MEGA FAQ (Depth Driver) -->
  <section class="py-24 bg-[var(--bg-secondary)]">
    <div class="max-w-6xl mx-auto px-6">
      <div
        class="flex flex-col md:flex-row justify-between items-end mb-16 gap-8"
      >
        <div class="max-w-2xl">
          <h2
            class="text-4xl md:text-7xl font-black italic uppercase tracking-tighter"
          >
            Authority <span class="text-[var(--accent-red)]">Briefing</span>.
          </h2>
          <p class="text-xl text-[var(--text-secondary)] mt-4">
            Everything you need to know about {service.name} in {city.name}.
          </p>
        </div>
      </div>

      <div
        class="relative max-h-[800px] overflow-y-auto pr-4 scrollbar-thin scrollbar-thumb-[var(--accent-red)] scrollbar-track-[var(--bg-primary)]"
      >
        <div class="space-y-4 pb-24">
          {
            faqs.map((faq) => (
              <details class="group bg-[var(--bg-primary)] border border-[var(--border-subtle)] rounded-[2rem] overflow-hidden hover:border-[var(--accent-red)] transition-all">
                <summary class="flex items-center justify-between p-8 cursor-pointer list-none select-none">
                  <h3 class="text-xl font-bold pr-8 leading-tight">
                    {localize(faq.question)}
                  </h3>
                  <span class="text-[var(--accent-red)] font-black group-open:rotate-180 transition-transform">
                    ↓
                  </span>
                </summary>
                <div class="px-8 pb-8 text-[var(--text-secondary)] leading-loose border-t border-[var(--border-subtle)]">
                  <p>{localize(faq.answer)}</p>
                </div>
              </details>
            ))
          }
        </div>
        <div
          class="absolute bottom-0 left-0 right-0 h-40 bg-gradient-to-t from-[var(--bg-secondary)] to-transparent pointer-events-none sticky"
        >
        </div>
      </div>
    </div>
  </section>

  <!-- Cross-City Mesh -->
  <section
    class="py-24 bg-[var(--bg-primary)] border-t border-[var(--border-subtle)]"
  >
    <div class="max-w-7xl mx-auto px-6">
      <h3
        class="text-xs font-black uppercase tracking-[0.4em] text-[var(--text-muted)] text-center mb-12"
      >
        Regional Network for {service.name}
      </h3>
      <div class="flex flex-wrap justify-center gap-4">
        {
          cities
            .filter((c) => c.slug !== city.slug)
            .map((c) => (
              <a
                href={`/${c.slug}/${service.slug}`}
                class="px-6 py-3 bg-[var(--bg-card)] border border-[var(--border-subtle)] rounded-xl text-xs font-bold uppercase hover:border-[var(--accent-red)] transition-all"
              >
                {service.name.split(" ")[0]} in {c.name}
              </a>
            ))
        }
      </div>
    </div>
  </section>

  <!-- SECTION 6: REGIONAL HIGH-VELOCITY MESH -->
  <section
    class="py-24 bg-[var(--bg-secondary)] border-t border-[var(--border-subtle)]"
  >
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid md:grid-cols-2 gap-12">
        <!-- Vertical: Other Industries in this City -->
        <div
          class="p-12 bg-[var(--bg-primary)] rounded-[4rem] border border-[var(--border-subtle)]"
        >
          <h4
            class="text-[10px] font-black uppercase tracking-[0.4em] text-[var(--accent-red)] mb-10"
          >
            Sector Authority in {city.name}
          </h4>
          <div class="grid grid-cols-2 gap-4">
            {
              industries.slice(0, 8).map((ind) => (
                <a
                  href={`/${city.slug}/${ind.slug}/${service.slug}`}
                  class="p-4 bg-[var(--bg-secondary)] border border-[var(--border-subtle)] rounded-2xl text-xs font-black uppercase tracking-tight hover:text-[var(--accent-red)] hover:border-[var(--accent-red)] transition-all"
                >
                  {ind.name}
                </a>
              ))
            }
          </div>
        </div>

        <!-- Horizontal: Same Service in regional hubs -->
        <div
          class="p-12 bg-[var(--bg-primary)] rounded-[4rem] border border-[var(--border-subtle)]"
        >
          <h4
            class="text-[10px] font-black uppercase tracking-[0.4em] text-[var(--accent-yellow)] mb-10"
          >
            Regional {service.name} Network
          </h4>
          <div class="flex flex-wrap gap-3">
            {
              cities
                .filter((c) => c.slug !== city.slug)
                .slice(0, 12)
                .map((c) => (
                  <a
                    href={`/${c.slug}/${service.slug}`}
                    class="text-[10px] font-black uppercase tracking-widest text-[var(--text-muted)] hover:text-[var(--text-primary)] transition-colors py-2 px-4 bg-[var(--bg-secondary)] rounded-full border border-[var(--border-subtle)]"
                  >
                    {c.name} Hub
                  </a>
                ))
            }
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>
