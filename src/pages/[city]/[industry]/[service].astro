---
import Layout from "../../../layouts/Layout.astro";
import { services, industries, cities } from "../../../config/site-config";
import servicesContent from "../../../data/services-content.json";
import industryContent from "../../../data/industry-content.json";

export function getStaticPaths() {
  const paths = [];
  
  // Generating programmatic combinations for all cities, industries, and services
  for (const city of cities) {
    for (const industry of industries) {
      for (const service of services) {
        paths.push({
          params: { 
            city: city.slug, 
            industry: industry.slug, 
            service: service.slug 
          },
          props: { city, industry, service },
        });
      }
    }
  }
  
  return paths;
}

const { city, industry, service } = Astro.props;
const content = servicesContent[service.slug as keyof typeof servicesContent];
const industryData = industryContent.industries[industry.slug as keyof typeof industryContent.industries] || industryContent.industries.default;

const canonicalURL = new URL(Astro.url.pathname, "https://vdesignu.com");

// Localize content helper
const localize = (text: string) => {
  if (!text) return "";
  return text
    .replace(/{city}/g, city.name)
    .replace(/{service}/g, service.name)
    .replace(/{industry}/g, industry.name)
    .replace(/Gulf region/g, city.name)
    .replace(/UAE/g, city.country)
    .replace(/Dubai/g, city.name)
    .replace(/Saudi Arabia/g, city.country)
    .replace(/B2B and B2C/g, `${industry.name} B2B & B2C`)
    .replace(/B2B industrial/g, `${industry.name} B2B`)
    .replace(/industrial/g, industry.name.toLowerCase());
};

// Combine FAQs: Global service FAQs + Industry-specific FAQs
const industryFaqs = industryData.faqs || [];
const allFaqs = [...industryFaqs];

// JSON-LD for AI SEO (GEO) & FAQ Schema
const jsonLd = [
  {
    "@context": "https://schema.org",
    "@type": "Service",
    "name": `${service.name} for ${industry.name} in ${city.name}`,
    "description": `Leading ${service.name.toLowerCase()} solutions for the ${industry.name.toLowerCase()} sector in ${city.name}, ${city.country}.`,
    "provider": {
      "@type": "LocalBusiness",
      "name": "vdesignu",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": city.name,
        "addressCountry": city.country
      }
    },
    "areaServed": {
      "@type": "City",
      "name": city.name
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": allFaqs.map(faq => ({
      "@type": "Question",
      "name": localize(faq.question),
      "acceptedAnswer": {
        "@type": "Answer",
        "text": localize(faq.answer)
      }
    }))
  }
];
---

<Layout 
  title={`${service.name} for ${industry.name} Firms in ${city.name} | Reliable ${city.country} Agency`} 
  description={`Looking for ${service.name.toLowerCase()} in ${city.name}? We help ${industry.name.toLowerCase()} companies grow with high-performance digital systems. Trusted by ${city.country} business leaders.`}
  canonical={canonicalURL.toString()}
>
  <!-- Schema.org for AI SEO (GEO) -->
  <script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />

  <!-- SEO Hero -->
  <section class="pt-40 pb-24 bg-[var(--bg-primary)] overflow-hidden relative">
    <div class="absolute inset-0 bg-[var(--accent-red)]/5 opacity-30"></div>
    <div class="absolute top-0 right-0 w-[600px] h-[600px] bg-[var(--accent-yellow)]/5 rounded-full blur-[120px]"></div>
    
    <div class="max-w-7xl mx-auto px-6 relative z-10 text-center lg:text-left">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-xs font-black uppercase tracking-widest mb-8 border border-red-100 dark:border-red-900/30">
        Local Leader: {city.name} &bull; {industry.name} Specialist
      </div>
      
      <h1 class="text-3xl sm:text-4xl md:text-6xl lg:text-7xl font-black italic uppercase tracking-tighter leading-[0.9] text-[var(--text-primary)] mb-10 translate-y-[-5%]">
        {service.name}<br/>
        For <span class="text-[var(--accent-red)]">{industry.name}</span><br/>
        In <span class="relative">
          {city.name}
          <div class="absolute -bottom-2 left-0 w-full h-2 bg-[var(--accent-yellow)]/30 rounded-full blur-sm"></div>
        </span>
      </h1>
      
      <p class="text-xl md:text-2xl font-medium text-[var(--text-secondary)] max-w-4xl mb-12 leading-relaxed">
        {localize(content?.heroDescription || `We help ${industry.name.toLowerCase()} firms in ${city.name} grow their business with expert ${service.name.toLowerCase()}.`)}
      </p>
      
      <div class="flex flex-col sm:flex-row gap-6 justify-center lg:justify-start">
        <a href="/contact" class="px-10 py-5 bg-[var(--accent-red)] text-white font-black italic rounded-xl hover:bg-black transition-all shadow-xl uppercase tracking-tighter text-2xl active:scale-95">
          Get Free Audit
        </a>
        <div class="flex items-center gap-4 text-[var(--text-muted)] font-bold uppercase tracking-widest text-xs px-6 py-4 bg-[var(--bg-secondary)] rounded-xl border border-[var(--border-subtle)]">
           <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
           Active in {city.name}
        </div>
      </div>
    </div>
  </section>

  <!-- Local Insight Section -->
  <section class="py-24 bg-[var(--bg-secondary)] border-y border-[var(--border-subtle)]">
    <div class="max-w-4xl mx-auto px-6">
      <h2 class="text-4xl md:text-6xl font-black italic uppercase tracking-tighter text-[var(--text-primary)] mb-8 leading-[0.95]">
        Solving <span class="text-[var(--accent-red)]">{industry.name}</span> Challenges In <span class="text-[var(--accent-yellow)]">{city.name}</span>.
      </h2>
      <div class="prose prose-xl dark:prose-invert text-[var(--text-secondary)]">
        <p class="mb-8 font-medium">{localize((industryData as any).painPoints || content?.sections.overview.content || "")}</p>
        
        <p class="mb-8">
           {localize((industryData as any).solution || `In ${city.name}, ${industry.name.toLowerCase()} companies face a unique set of digital hurdles. From managing multi-lingual procurement to staying ahead in a hyper-competitive ${city.country} market, traditional out-of-the-box software often fails to deliver the precision required for business excellence.`)} Our {service.name.toLowerCase()} are engineered specifically to bridge this gap. We combine international standards with an intimate understanding of how business is done in {city.name}, ensuring your technical infrastructure is an asset, not a bottleneck.
        </p>

        <div class="grid md:grid-cols-2 gap-8 not-prose mt-12">
           <div class="p-8 rounded-3xl bg-[var(--bg-primary)] border-2 border-[var(--border-subtle)] group hover:border-[var(--accent-yellow)] transition-all">
              <div class="text-[var(--accent-yellow)] font-black text-4xl mb-2">127%</div>
              <div class="text-xs font-black uppercase tracking-widest text-[var(--text-primary)]">Average Pipeline Boost</div>
              <p class="text-[10px] text-[var(--text-muted)] mt-2 uppercase tracking-tighter">Observed in {industry.name} sectors across {city.name}.</p>
           </div>
           <div class="p-8 rounded-3xl bg-[var(--bg-primary)] border-2 border-[var(--border-subtle)] group hover:border-[var(--accent-red)] transition-all">
              <div class="text-[var(--accent-red)] font-black text-4xl mb-2">0.8s</div>
              <div class="text-xs font-black uppercase tracking-widest text-[var(--text-primary)]">Site Response Latency</div>
              <p class="text-[10px] text-[var(--text-muted)] mt-2 uppercase tracking-tighter">Optimized for {city.country} network infrastructure.</p>
           </div>
        </div>

        <p class="mt-12 text-lg">
           By focusing on the specific intent of {city.name}-based buyers, we ensure your {service.name.toLowerCase()} is more than just a presenceâ€”it's a lead generation machine. Whether you're operating in {city.name}'s business zones or serving global clients from your {city.country} headquarters, our systems are built to give you a clear advantage.
        </p>
      </div>
    </div>
  </section>

  <!-- Strategic Capabilities -->
  {content && (
    <section class="py-24 bg-[var(--bg-primary)]">
      <div class="max-w-7xl mx-auto px-6">
        <div class="text-center mb-16">
           <h3 class="text-xs font-bold uppercase tracking-[0.4em] text-red-600 mb-4">Core Capabilities</h3>
           <h2 class="text-4xl md:text-6xl font-black italic uppercase tracking-tighter text-[var(--text-primary)]">
              Tailored For <span class="text-[var(--accent-yellow)]">{industry.name}</span>.
           </h2>
        </div>
        
        <div class="grid md:grid-cols-3 gap-8">
           {content.sections.whatWeOffer.items.map((item: any) => (
             <div class="bg-[var(--bg-card)] p-10 rounded-[2.5rem] border-2 border-[var(--border-subtle)] group hover:border-[var(--accent-red)] transition-all relative overflow-hidden">
                <div class="absolute top-0 right-0 p-6 text-6xl font-black italic tracking-tighter text-[var(--accent-red)] opacity-5 group-hover:opacity-10 transition-opacity">
                  0{content.sections.whatWeOffer.items.indexOf(item) + 1}
                </div>
                <h4 class="text-2xl font-bold text-[var(--text-primary)] uppercase tracking-tight mb-4 group-hover:text-[var(--accent-red)] transition-colors leading-tight">
                  {item.title}
                </h4>
                <p class="text-[var(--text-secondary)] leading-relaxed">
                  {localize(item.description)}
                </p>
             </div>
           ))}
        </div>
      </div>
    </section>
  )}

  <!-- Strategic FAQs (Search Intent Optimized) -->
  <section class="py-24 bg-[var(--bg-secondary)] overflow-hidden relative">
    <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-[var(--accent-yellow)]/5 rounded-full blur-[100px] -translate-y-1/2"></div>
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex flex-col md:flex-row justify-between items-end mb-16 gap-8">
        <div class="max-w-2xl">
          <h3 class="text-xs font-bold uppercase tracking-[0.4em] text-red-600 mb-4">Strategic Intelligence</h3>
          <h2 class="text-4xl md:text-6xl font-black italic uppercase tracking-tighter text-[var(--text-primary)] leading-[0.9]">
            Search Intent & <span class="text-[var(--accent-red)]">Growth Insights</span>.
          </h2>
        </div>
        <div class="text-right">
          <div class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-green-500/10 border border-green-500/20 text-green-600 text-[10px] font-black uppercase tracking-widest">
            <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span>
            Updated for {city.name} {new Date().getFullYear()}
          </div>
        </div>
      </div>

      <div class="grid lg:grid-cols-2 gap-8">
        {allFaqs.map((faq) => (
          <div class="bg-[var(--bg-primary)] p-8 md:p-10 rounded-[2rem] border-2 border-[var(--border-subtle)] hover:border-[var(--accent-yellow)] transition-all group">
            <div class="flex gap-6">
              <div class="flex-shrink-0 w-10 h-10 rounded-full bg-[var(--accent-red)]/10 flex items-center justify-center text-[var(--accent-red)] font-black italic">
                ?
              </div>
              <div>
                <h4 class="text-xl md:text-2xl font-black text-[var(--text-primary)] uppercase tracking-tight mb-6 group-hover:text-[var(--accent-red)] transition-colors leading-tight">
                  {localize(faq.question)}
                </h4>
                <div class="h-px w-12 bg-[var(--accent-yellow)] mb-6"></div>
                <p class="text-[var(--text-secondary)] leading-relaxed font-medium">
                  {localize(faq.answer)}
                </p>
              </div>
            </div>
          </div>
        ))}
      </div>
      
      {allFaqs.length > 8 && (
        <div class="mt-12 text-center">
          <p class="text-xs font-bold uppercase tracking-widest text-[var(--text-muted)]">
            + More context-specific answers engineered for {industry.name} leaders in {city.name}.
          </p>
        </div>
      )}
    </div>
  </section>

  <!-- Cross-Linking (SEO Integrity) -->
  <section class="py-24 bg-[var(--bg-secondary)] border-t border-[var(--border-subtle)]">
    <div class="max-w-7xl mx-auto px-6">
       <div class="grid md:grid-cols-2 gap-16">
         <!-- Related Sectors in this City -->
         <div>
           <h4 class="text-xs font-black uppercase tracking-[0.4em] text-[var(--text-primary)] mb-8 border-l-4 border-[var(--accent-red)] pl-4">Sector Hubs in {city.name}</h4>
           <div class="grid grid-cols-2 gap-3">
             {industries.slice(0, 10).map((otherIndustry) => (
               <a href={`/${city.slug}/${otherIndustry.slug}/${service.slug}`} class="px-4 py-3 rounded-xl border border-[var(--border-subtle)] bg-[var(--bg-primary)] text-[10px] font-bold uppercase tracking-widest hover:border-[var(--accent-red)] hover:text-[var(--accent-red)] transition-all">
                 {otherIndustry.name} {service.name.split(' ')[0]}
               </a>
             ))}
           </div>
         </div>

         <!-- This Service in other Cities -->
         <div>
           <h4 class="text-xs font-black uppercase tracking-[0.4em] text-[var(--text-primary)] mb-8 border-l-4 border-[var(--accent-yellow)] pl-4">{service.name} Regional Reach</h4>
           <div class="grid grid-cols-2 gap-3">
             {cities.slice(0, 10).map((otherCity) => (
               <a href={`/${otherCity.slug}/${industry.slug}/${service.slug}`} class="px-4 py-3 rounded-xl border border-[var(--border-subtle)] bg-[var(--bg-primary)] text-[10px] font-bold uppercase tracking-widest hover:border-[var(--accent-yellow)] hover:text-[var(--accent-yellow)] transition-all">
                 {service.name.split(' ')[0]} in {otherCity.name}
               </a>
             ))}
           </div>
         </div>
       </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="py-24 bg-[var(--accent-red)] text-white text-center">
    <div class="max-w-4xl mx-auto px-6">
      <h2 class="text-3xl sm:text-4xl md:text-7xl font-black italic uppercase tracking-tighter text-white mb-8 leading-[0.95]">
        Dominate the <span class="text-[var(--accent-yellow)]">{industry.name}</span> Sector in {city.name} Toda<span class="text-[var(--accent-yellow)]">y.</span>
      </h2>
      <a href="/contact" class="inline-block px-10 py-5 md:px-12 md:py-6 bg-white text-[var(--accent-red)] font-black italic uppercase tracking-tighter text-xl md:text-2xl rounded-xl hover:bg-black hover:text-white transition-all shadow-2xl active:scale-95">
        Get Free Audit
      </a>
    </div>
  </section>
</Layout>
